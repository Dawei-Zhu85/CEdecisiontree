<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using other input formats â€¢ CEdecisiontree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using other input formats">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CEdecisiontree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/comparison-with-other-packages.html">Comparison with other packages</a>
    </li>
    <li>
      <a href="../articles/other-input-formats.html">Using other input formats</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/scenario-sensitivity-analysis.html">Scenario Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/Using_function_dispatch.html">Using function dispatch</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using other input formats</h1>
                        <h4 class="author">Nathan Green</h4>
            
            <h4 class="date">2019-01-06</h4>
      
      
      <div class="hidden name"><code>other-input-formats.Rmd</code></div>

    </div>

    
    
<p>The main aim of the CEdecisiontree package is to provide a bridge to models that would be otherwise build in Excel. Because of this the transition matrix format for input arguments is the primary format. However, this is not necessarily the easiest to define, manipulate or compute with. Here we give some examples alternative formats.</p>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>Quietly load libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(CEdecisiontree))</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(readr))</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; Warning: package 'readr' was built under R version 3.4.4</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr))</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.4.4</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(reshape2))</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; Warning: package 'reshape2' was built under R version 3.4.4</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr))</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; Warning: package 'tidyr' was built under R version 3.4.4</span></a></code></pre></div>
<p>Load example data from the package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"cost"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"probs"</span>)</a></code></pre></div>
</div>
<div id="tree-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#tree-structure" class="anchor"></a>Tree structure</h2>
<p>Generally, we can specify a tree by who the children are for each parent node. This can be more compuationally efficient.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">tree &lt;-</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"1"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb3-3" title="3">      <span class="st">"2"</span> =<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb3-4" title="4">      <span class="st">"3"</span> =<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">6</span>,<span class="dv">7</span>),</a>
<a class="sourceLine" id="cb3-5" title="5">      <span class="st">"4"</span> =<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(),</a>
<a class="sourceLine" id="cb3-6" title="6">      <span class="st">"5"</span> =<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(),</a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="st">"6"</span> =<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(),</a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="st">"7"</span> =<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>())</a>
<a class="sourceLine" id="cb3-9" title="9">vals &lt;-</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">node =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,</a>
<a class="sourceLine" id="cb3-11" title="11">            <span class="dt">probs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="ot">NA</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>),</a>
<a class="sourceLine" id="cb3-12" title="12">            <span class="dt">cost =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-13" title="13">tree</a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; $`1`</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; [1] 2 3</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; $`2`</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; [1] 4 5</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt; $`3`</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt; [1] 6 7</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; $`4`</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; $`5`</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">#&gt; $`6`</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; $`7`</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb3-34" title="34">vals</a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt;   node probs cost</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; 1    1    NA    0</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt; 2    2   0.2   10</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt; 3    3   0.8    1</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt; 4    4   0.2   10</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt; 5    5   0.8    1</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt; 6    6   0.2   10</span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt; 7    7   0.8    1</span></a>
<a class="sourceLine" id="cb3-43" title="43"></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="kw"><a href="../reference/CEdecisiontree_recursive.html">CEdecisiontree_recursive</a></span>(tree, vals)</a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt; numeric(0)</span></a></code></pre></div>
<p>We can obtain the list of children from the probability matrix (or any other structure defining transition matrix).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/get_children_list.html">get_children_list</a></span>(probs)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; $`1`</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; [1] 2 3</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; $`2`</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; [1] 4 5</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; $`3`</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; [1] 6 7</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; $`4`</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; integer(0)</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; $`5`</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; integer(0)</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt; $`6`</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; integer(0)</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; $`7`</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; integer(0)</span></a></code></pre></div>
</div>
<div id="single-long-array" class="section level2">
<h2 class="hasAnchor">
<a href="#single-long-array" class="anchor"></a>Single long array</h2>
<p>If we keep with flat arrays then clearly, as the size of the tree increased the sparse matrices become impractical. We can provide a long format array to address this. Let us transform the wide array used previously to demonstrate the structure and space saving.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">probs_long &lt;-</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span>probs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">'from'</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  </span><span class="kw">melt</span>(<span class="dt">id.vars =</span> <span class="st">"from"</span>,</a>
<a class="sourceLine" id="cb5-5" title="5">       <span class="dt">variable.name =</span> <span class="st">'to'</span>,</a>
<a class="sourceLine" id="cb5-6" title="6">       <span class="dt">value.name =</span> <span class="st">'prob'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/na.fail">na.omit</a></span>()</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; Warning: package 'bindrcpp' was built under R version 3.4.4</span></a>
<a class="sourceLine" id="cb5-9" title="9"></a>
<a class="sourceLine" id="cb5-10" title="10">cost_long &lt;-</a>
<a class="sourceLine" id="cb5-11" title="11"><span class="st">  </span>cost <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">'from'</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="st">  </span><span class="kw">melt</span>(<span class="dt">id.vars =</span> <span class="st">"from"</span>,</a>
<a class="sourceLine" id="cb5-14" title="14">       <span class="dt">variable.name =</span> <span class="st">'to'</span>,</a>
<a class="sourceLine" id="cb5-15" title="15">       <span class="dt">value.name =</span> <span class="st">'cost'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/na.fail">na.omit</a></span>()</a>
<a class="sourceLine" id="cb5-17" title="17"></a>
<a class="sourceLine" id="cb5-18" title="18">dat_long &lt;-</a>
<a class="sourceLine" id="cb5-19" title="19"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/merge">merge</a></span>(probs_long,</a>
<a class="sourceLine" id="cb5-20" title="20">        cost_long)</a>
<a class="sourceLine" id="cb5-21" title="21"></a>
<a class="sourceLine" id="cb5-22" title="22">dat_long</a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt;   from to prob cost</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; 1    1  2  0.2   10</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; 2    1  3  0.8    1</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt; 3    2  4  0.2   10</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt; 4    2  5  0.8    1</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt; 5    3  6  0.2   10</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt; 6    3  7  0.8    1</span></a></code></pre></div>
<p>We can use the long array as the input argument instead of the separate transition matrices. Internally, we simple convert back to a matrix using <code><a href="../reference/long_to_transmat.html">long_to_transmat()</a></code> so for larger trees this may be inefficient.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/dectree_expected_values.default.html">dectree_expected_values</a></span>(<span class="dt">dat =</span> dat_long)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; Using prob as value column: use value.var to override.</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; Using cost as value column: use value.var to override.</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; [1] 5.6 2.8 2.8 0.0 0.0 0.0 0.0</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#tree-structure">Tree structure</a></li>
      <li><a href="#single-long-array">Single long array</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nathan Green.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
